import{M as p,d as z,m as V,D as A,y as D,r as i,o as N,c as O,g as e,w as a,B as u,t as j,q as d,f as E,P as C,F,J as _}from"./index-DiapZNiM.js";const H=()=>p.get("/admin/acl/permission"),R=m=>m.id?p.put("/admin/acl/permission/update",m):p.post("/admin/acl/permission/save",m),T=m=>p.delete("/admin/acl/permission/remove/"+m),I={class:"dialog-footer"},w=z({__name:"index",setup(m){let v=V([]),o=V(!1),s=A({code:"",level:0,name:"",pid:0});D(()=>{f()});const f=async()=>{let t=await H();t.code==200&&(v.value=t.data)},k=t=>{Object.assign(s,{id:0,code:"",level:0,name:"",pid:0}),o.value=!0,s.level=t.level+1,s.pid=t.id},x=t=>{o.value=!0,Object.assign(s,t)},P=async t=>{(await T(t)).code==200&&(_({type:"success",message:"删除成功"}),f())},M=async()=>{let t=await R(s);t.code==200?(o.value=!1,_({type:"success",message:s.id?"更新成功":"添加成功"}),f(),console.log("getHasPermisstion")):_({type:"error",message:t.message})};return(t,n)=>{const c=i("el-table-column"),r=i("el-button"),$=i("el-popconfirm"),q=i("el-table"),b=i("el-input"),g=i("el-form-item"),B=i("el-form"),U=i("el-dialog");return N(),O(F,null,[e(q,{"row-key":"id",data:d(v)},{default:a(()=>[e(c,{label:"名称",prop:"name"}),e(c,{label:"权限值",prop:"code"}),e(c,{label:"修改时间",prop:"updateTime"}),e(c,{label:"操作"},{default:a(({row:l,$index:J})=>[e(r,{type:"primary",onClick:y=>k(l),size:"small",disabled:l.level===4},{default:a(()=>[u(j(l.level===3?"添加功能":"添加菜单"),1)]),_:2},1032,["onClick","disabled"]),e(r,{type:"warning",onClick:y=>x(l),size:"small",disabled:l.level===1},{default:a(()=>[u("编辑")]),_:2},1032,["onClick","disabled"]),e($,{title:`你确定要删除${l.name}?`,width:"260px",onConfirm:y=>P(l.id)},{reference:a(()=>[e(r,{type:"danger",size:"small",disabled:l.level===1},{default:a(()=>[u("删除")]),_:2},1032,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(U,{modelValue:d(o),"onUpdate:modelValue":n[3]||(n[3]=l=>C(o)?o.value=l:o=l),title:d(s).id?"更新菜单":"添加菜单"},{footer:a(()=>[E("span",I,[e(r,{onClick:n[2]||(n[2]=l=>C(o)?o.value=!1:o=!1)},{default:a(()=>[u("取消")]),_:1}),e(r,{type:"primary",onClick:M},{default:a(()=>[u(" 确定 ")]),_:1})])]),default:a(()=>[e(B,null,{default:a(()=>[e(g,{label:"名称"},{default:a(()=>[e(b,{placeholder:"请你输入菜单名称",modelValue:d(s).name,"onUpdate:modelValue":n[0]||(n[0]=l=>d(s).name=l)},null,8,["modelValue"])]),_:1}),e(g,{label:"权限"},{default:a(()=>[e(b,{placeholder:"请你输入权限数值",modelValue:d(s).code,"onUpdate:modelValue":n[1]||(n[1]=l=>d(s).code=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])],64)}}});export{w as default};
