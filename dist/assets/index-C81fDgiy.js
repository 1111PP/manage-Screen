import{d as R,Q as G,m as b,n as H,D as W,K as X,r as i,o as f,c as h,g as e,q as _,w as n,O as N,f as k,B as p,F as B,b as Y,e as S,t as w,S as x,T as Z,U as ee,J as y,v as O,V as te}from"./index-DiapZNiM.js";const ae=["onClick"],se=R({__name:"index",setup(le){const d=G(),v=b([]),C=async()=>{const{firstCurrID:a,secondCurrID:r,thirdCurrID:g}=d,s=await Z(a,r,g);v.value=s.data};H(()=>d.thirdCurrID,async()=>{v.value=[],d.thirdCurrID&&await C()});let c=b(0);const U=()=>{c.value=1},$=a=>{c.value=1,Object.assign(t,JSON.parse(JSON.stringify(a)))},q=async a=>{(await ee(a)).code===200&&(await C(),y({type:"success",message:"删除成功"}))},t=W({attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),z=()=>{t.attrValueList.push({valueName:"",flag:!0}),O(()=>{V.value[t.attrValueList.length-1].focus()})},E=a=>{t.attrValueList=t.attrValueList.filter(r=>r!==a)},T=(a,r)=>{if(console.log(a),a.valueName.trim()){if(t.attrValueList.find(s=>{if(s!=a)return s.valueName===a.valueName})){y({type:"error",message:"属性值不能重复"}),t.attrValueList=t.attrValueList.filter(s=>s!=a);return}}else{y({type:"error",message:"属性值不能为空"}),t.attrValueList.splice(r,1);return}a.flag=!1},J=(a,r)=>{a.flag=!0,console.log(r),O(()=>{V.value[r].focus()})},L=()=>{Object.assign(t,{attrName:"",attrValueList:[],categoryId:"",categoryLevel:3})},A=()=>{c.value=0,L()},M=async()=>{t.categoryId=d.thirdCurrID,(await te(t)).code===200&&(y({type:"success",message:t.id?"Successfully Edit":"Successfully Added"}),await C(),c.value=0),L()},V=b([]);return X(()=>{d.resetStore()}),(a,r)=>{const g=i("Category"),s=i("el-button"),u=i("el-table-column"),P=i("el-tag"),j=i("el-popconfirm"),D=i("el-table"),I=i("el-input"),F=i("el-form-item"),K=i("el-form"),Q=i("el-card");return f(),h(B,null,[e(g,{scene:_(c)},null,8,["scene"]),e(Q,{style:{"margin-top":"10px"},class:"attr-main"},{default:n(()=>[N(k("div",null,[e(s,{disabled:!_(d).thirdCurrID,type:"primary",icon:"plus",onClick:U},{default:n(()=>[p("添加属性")]),_:1},8,["disabled"]),e(D,{border:"",style:{margin:"10px 0"},data:v.value},{default:n(()=>[e(u,{type:"index",label:"序号",align:"center",width:"80px"}),e(u,{prop:"attrName",label:"属性名称",width:"120px"}),e(u,{label:"属性值名称"},{default:n(({row:l,index:m})=>[(f(!0),h(B,null,Y(l.attrValueList,o=>(f(),S(P,{style:{margin:"0 5px"},key:o.id},{default:n(()=>[p(w(o.valueName),1)]),_:2},1024))),128))]),_:1}),e(u,{prop:" operation",label:"操作",width:"120px"},{default:n(({row:l,index:m})=>[e(s,{onClick:o=>$(l),type:"warning",size:"small",icon:"edit"},null,8,["onClick"]),e(j,{width:"200px",onConfirm:o=>q(l.id),title:`确认删除${l.attrName}?`},{reference:n(()=>[e(s,{type:"danger",size:"small",icon:"delete"})]),_:2},1032,["onConfirm","title"])]),_:1})]),_:1},8,["data"])],512),[[x,_(c)==0]]),N(k("div",null,[e(K,null,{default:n(()=>[e(F,{label:"属性名称:"},{default:n(()=>[e(I,{modelValue:t.attrName,"onUpdate:modelValue":r[0]||(r[0]=l=>t.attrName=l),placeholder:"请输入属性名称",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(s,{disabled:!t.attrName,type:"primary",icon:"plus",onClick:z},{default:n(()=>[p("添加属性值")]),_:1},8,["disabled"]),e(s,{onClick:A},{default:n(()=>[p("取消")]),_:1}),e(D,{border:"",style:{margin:"10px 0"},data:t.attrValueList},{default:n(()=>[e(u,{label:"序号",type:"index",width:"80px",align:"center"}),e(u,{label:"属性值"},{default:n(({row:l,$index:m})=>[l.flag?(f(),S(I,{key:0,ref:o=>V.value[m]=o,onBlur:o=>T(l,m),size:"small",placeholder:"请输入属性值",modelValue:l.valueName,"onUpdate:modelValue":o=>l.valueName=o},null,8,["onBlur","modelValue","onUpdate:modelValue"])):(f(),h("div",{key:1,onClick:o=>J(l,m)},w(l.valueName),9,ae))]),_:1}),e(u,{label:"操作",width:"120px"},{default:n(({row:l,$index:m})=>[e(s,{onClick:o=>E(l),icon:"delete",type:"danger",size:"small"},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),e(s,{type:"success",onClick:M,disabled:!(t.attrValueList.length>0)},{default:n(()=>[p("保存")]),_:1},8,["disabled"]),e(s,{onClick:A},{default:n(()=>[p("取消")]),_:1})]),_:1})],512),[[x,_(c)===1]]),N(k("div",null," 456 ",512),[[x,_(c)===2]])]),_:1})],64)}}});export{se as default};
